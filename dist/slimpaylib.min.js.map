{"version":3,"sources":["auth.js","client.js","halIndex.js","index.js","paymentManager.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","request","require","Auth","options","this","app_name","app_secret","oauth_url","token","renovation_date","expires_in","value","next","_this","_is_token_valid","access_token","_retrieve_token","err","Error","now","Date","callback","self","post","form","grant_type","scope","auth","user","pass","res","body","JSON","parse","Client","url","getBearer","bearer","method","headers","Authorization","Accept","profile","console","log","object","halIndex","links","global","sandbox_entrypoint_url","process","env","entrypoint_url","exports","Slimpaylib","creditor_reference","payment","PaymentManager","do_auth","sign_mandate","module","client","entryUrl","do_get"],"mappings":"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","file":"slimpaylib.min.js","sourcesContent":["'use strict';\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar request = require('request');\n\nvar Auth = function () {\n\tfunction Auth(options) {\n\t\t_classCallCheck(this, Auth);\n\n\t\tthis.app_name = options.app_name;\n\t\tthis.app_secret = options.app_secret;\n\t\tthis.oauth_url = options.oauth_url;\n\t\tthis.token = {};\n\t\tthis.renovation_date = 0;\n\t\tthis.token.expires_in = 0;\n\t}\n\n\t_createClass(Auth, [{\n\t\tkey: 'getBearer',\n\t\tvalue: function getBearer(next) {\n\t\t\tvar _this = this;\n\n\t\t\tif (!this._is_token_valid()) {\n\t\t\t\tthis._retrieve_token(function (err) {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\tthrow new Error('Authentication error');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnext(_this.token.access_token);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tnext(this.token.access_token);\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: '_is_token_valid',\n\t\tvalue: function _is_token_valid() {\n\t\t\tvar now = new Date() / 1000;\n\t\t\treturn now < this.renovation_date + this.token.expires_in;\n\t\t}\n\t}, {\n\t\tkey: '_retrieve_token',\n\t\tvalue: function _retrieve_token(callback) {\n\t\t\tvar self = this;\n\t\t\trequest.post(this.oauth_url, {\n\t\t\t\tform: {\n\t\t\t\t\tgrant_type: 'client_credentials',\n\t\t\t\t\tscope: 'api'\n\t\t\t\t},\n\t\t\t\tauth: {\n\t\t\t\t\tuser: this.app_name,\n\t\t\t\t\tpass: this.app_secret\n\t\t\t\t}\n\t\t\t}, function (err, res, body) {\n\t\t\t\tself.token = JSON.parse(body);\n\t\t\t\tself.renovation_date = new Date() / 1000;\n\t\t\t\tcallback(err);\n\t\t\t});\n\t\t}\n\t}]);\n\n\treturn Auth;\n}();","'use strict';\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar request = require('request');\n\nvar Client = function () {\n\tfunction Client(auth) {\n\t\t_classCallCheck(this, Client);\n\n\t\tthis.auth = auth;\n\t}\n\n\t_createClass(Client, [{\n\t\tkey: 'do_get',\n\t\tvalue: function do_get(url, callback) {\n\t\t\tthis.auth.getBearer(function (bearer) {\n\t\t\t\tvar options = {\n\t\t\t\t\turl: url,\n\t\t\t\t\tmethod: 'GET',\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': 'Bearer ' + bearer,\n\t\t\t\t\t\t'Accept': 'application/hal+json',\n\t\t\t\t\t\t'profile': 'https://api.slimpay.net/alps/v1'\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\trequest(options, function (err, res, body) {\n\t\t\t\t\tif (err) console.log(\"do_get error\", err);\n\t\t\t\t\tcallback(err, body);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}, {\n\t\tkey: 'do_post',\n\t\tvalue: function do_post(url, object, callback) {\n\t\t\tthis.auth.getBearer(function (bearer) {\n\t\t\t\tvar options = {\n\t\t\t\t\turl: url,\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t'Authorization': 'Bearer ' + bearer,\n\t\t\t\t\t\t'Accept': 'application/hal+json',\n\t\t\t\t\t\t'profile': 'https://api.slimpay.net/alps/v1'\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\trequest(options, function (err, res, body) {\n\t\t\t\t\tif (err) console.log(\"do_get error\", err);\n\t\t\t\t\tcallback(err, body);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}]);\n\n\treturn Client;\n}();","'use strict';\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar request = require('request');\n\nvar halIndex = function halIndex() {\n\t_classCallCheck(this, halIndex);\n\n\tthis.links = {};\n\tvar url = global.sandbox_entrypoint_url;\n\tif (process.env['NODE_ENV'] === 'production') {\n\t\turl = global.entrypoint_url;\n\t}\n};","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Slimpaylib = function () {\n  function Slimpaylib(options) {\n    _classCallCheck(this, Slimpaylib);\n\n    if (!options) throw new Error(\"Missing credentials\");\n    if (!options.app_name) throw new Error(\"Missing app_name\");\n    if (!options.app_secret) throw new Error(\"Missing app_secret\");\n    if (!options.creditor_reference) throw new Error(\"Missing creditor_reference\");\n    this.auth = new Auth(options);\n    this.payment = new PaymentManager(this.auth, options);\n  }\n\n  _createClass(Slimpaylib, [{\n    key: \"test\",\n    value: function test() {\n      var _this = this;\n\n      this.auth.do_auth(function () {\n        console.log(_this.auth.token);\n      });\n    }\n  }, {\n    key: \"sign_mandate\",\n    value: function sign_mandate(callback) {\n      this.payment.sign_mandate(callback);\n    }\n  }]);\n\n  return Slimpaylib;\n}();\n\nexports.default = Slimpaylib;\nmodule.exports = exports[\"default\"];","\"use strict\";\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar PaymentManager = function () {\n\tfunction PaymentManager(auth, options) {\n\t\t_classCallCheck(this, PaymentManager);\n\n\t\tthis.options = options;\n\t\tthis.client = new Client(auth);\n\t}\n\n\t_createClass(PaymentManager, [{\n\t\tkey: \"sign_mandate\",\n\t\tvalue: function sign_mandate(callback) {\n\t\t\tvar entryUrl = this.options.sandbox_entrypoint_url;\n\t\t\t//Retrieve entry point\n\t\t\tthis.client.do_get(entryUrl, function (err, links) {\n\t\t\t\tconsole.log(links);\n\t\t\t\tcallback();\n\t\t\t});\n\t\t\t//Create orders\n\t\t}\n\t}]);\n\n\treturn PaymentManager;\n}();"],"sourceRoot":"/source/"}