{"version":3,"sources":["auth.js","client.js","halIndex.js","index.js","paymentManager.js"],"names":["_classCallCheck","instance","Constructor","TypeError","Object","defineProperty","exports","value","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","request","require","Auth","options","this","app_name","app_secret","oauth_url","token","renovation_date","expires_in","next","_this","_is_token_valid","access_token","_retrieve_token","err","Error","now","Date","callback","post","form","grant_type","scope","auth","user","pass","res","body","Client","url","method","headers","Authorization","Accept","profile","console","log","object","halIndex","links","global","sandbox_entrypoint_url","process","env","entrypoint_url","Slimpaylib","creditor_reference","payment","PaymentManager","do_auth","sign_mandate","client","entryUrl","do_get"],"mappings":"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","file":"slimpaylib.min.js","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar request = require('request');\n\nvar Auth = function () {\n\tfunction Auth(options) {\n\t\t_classCallCheck(this, Auth);\n\n\t\tthis.app_name = options.app_name;\n\t\tthis.app_secret = options.app_secret;\n\t\tthis.oauth_url = options.oauth_url;\n\t\tthis.token = {};\n\t\tthis.renovation_date = 0;\n\t\tthis.token.expires_in = 0;\n\t}\n\n\t_createClass(Auth, [{\n\t\tkey: 'getBearer',\n\t\tvalue: function getBearer(next) {\n\t\t\tvar _this = this;\n\n\t\t\tif (!this._is_token_valid()) {\n\t\t\t\tthis._retrieve_token(function (err) {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\tthrow new Error('Authentication error');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnext(_this.token.access_token);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tnext(this.token.access_token);\n\t\t\t}\n\t\t}\n\t}, {\n\t\tkey: '_is_token_valid',\n\t\tvalue: function _is_token_valid() {\n\t\t\tvar now = new Date() / 1000;\n\t\t\treturn now < this.renovation_date + this.token.expires_in;\n\t\t}\n\t}, {\n\t\tkey: '_retrieve_token',\n\t\tvalue: function _retrieve_token(callback) {\n\t\t\trequest.post(this.oauth_url, {\n\t\t\t\tform: {\n\t\t\t\t\tgrant_type: 'client_credentials',\n\t\t\t\t\tscope: 'api'\n\t\t\t\t},\n\t\t\t\tauth: {\n\t\t\t\t\tuser: this.app_name,\n\t\t\t\t\tpass: this.app_secret\n\t\t\t\t}\n\t\t\t}, function (err, res, body) {\n\t\t\t\tthis.token = body;\n\t\t\t\tthis.renovation_date = new Date() / 1000;\n\t\t\t\tcallback(err);\n\t\t\t});\n\t\t}\n\t}]);\n\n\treturn Auth;\n}();\n\nexports.default = Auth;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar request = require('request');\n\nvar Client = function () {\n\tfunction Client(auth) {\n\t\t_classCallCheck(this, Client);\n\n\t\tthis.auth = auth;\n\t}\n\n\t_createClass(Client, [{\n\t\tkey: 'do_get',\n\t\tvalue: function do_get(url, callback) {\n\t\t\tvar options = {\n\t\t\t\turl: url,\n\t\t\t\tmethod: 'GET',\n\t\t\t\theaders: {\n\t\t\t\t\t'Authorization': 'Bearer ' + this.auth.token.access_token,\n\t\t\t\t\t'Accept': 'application/hal+json',\n\t\t\t\t\t'profile': 'https://api.slimpay.net/alps/v1'\n\t\t\t\t}\n\t\t\t};\n\t\t\trequest(options, function (err, res, body) {\n\t\t\t\tif (err) console.log(\"do_get error\", err);\n\t\t\t\tcallback(err, body);\n\t\t\t});\n\t\t}\n\t}, {\n\t\tkey: 'do_post',\n\t\tvalue: function do_post(url, object, callback) {\n\t\t\tvar options = {\n\t\t\t\turl: url,\n\t\t\t\tmethod: 'POST',\n\t\t\t\theaders: {\n\t\t\t\t\t'Authorization': 'Bearer ' + this.auth.token.access_token,\n\t\t\t\t\t'Accept': 'application/hal+json',\n\t\t\t\t\t'profile': 'https://api.slimpay.net/alps/v1'\n\t\t\t\t},\n\t\t\t\tform: object\n\t\t\t};\n\t\t\trequest(options, function (err, res, body) {\n\t\t\t\tif (err) console.log(\"do_post error\", err);\n\t\t\t\tcallback(err, body);\n\t\t\t});\n\t\t}\n\t}]);\n\n\treturn Client;\n}();\n\nexports.default = Client;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar request = require('request');\n\nvar halIndex = function halIndex() {\n\t_classCallCheck(this, halIndex);\n\n\tthis.links = {};\n\tvar url = global.sandbox_entrypoint_url;\n\tif (process.env['NODE_ENV'] === 'production') {\n\t\turl = global.entrypoint_url;\n\t}\n};\n\nexports.default = halIndex;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Slimpaylib = function () {\n  function Slimpaylib(options) {\n    _classCallCheck(this, Slimpaylib);\n\n    if (!options) throw new Error(\"Missing credentials\");\n    if (!options.app_name) throw new Error(\"Missing app_name\");\n    if (!options.app_secret) throw new Error(\"Missing app_secret\");\n    if (!options.creditor_reference) throw new Error(\"Missing creditor_reference\");\n    this.auth = new Auth(options);\n    this.payment = new PaymentManager(this.auth, options);\n  }\n\n  _createClass(Slimpaylib, [{\n    key: \"test\",\n    value: function test() {\n      var _this = this;\n\n      this.auth.do_auth(function () {\n        console.log(_this.auth.token);\n      });\n    }\n  }, {\n    key: \"sign_mandate\",\n    value: function sign_mandate() {\n      this.payment.sign_mandate();\n    }\n  }]);\n\n  return Slimpaylib;\n}();\n\nexports.default = Slimpaylib;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n\tvalue: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar PaymentManager = function () {\n\tfunction PaymentManager(auth, options) {\n\t\t_classCallCheck(this, PaymentManager);\n\n\t\tthis.options = options;\n\t\tthis.client = new Client(auth);\n\t}\n\n\t_createClass(PaymentManager, [{\n\t\tkey: \"sign_mandate\",\n\t\tvalue: function sign_mandate(callback) {\n\t\t\tvar entryUrl = this.options.sandbox_entrypoint_url;\n\t\t\t//Retrieve entry point\n\t\t\tthis.client.do_get(entryUrl, function (links) {\n\t\t\t\tconsole.log(links);\n\t\t\t\tcallback();\n\t\t\t});\n\t\t\t//Create orders\n\t\t}\n\t}]);\n\n\treturn PaymentManager;\n}();\n\nexports.default = PaymentManager;"],"sourceRoot":"/source/"}